<?xml version="1.0" encoding="utf-8"?>

<!-- If specifying a directory for output, ensure it exists before running ROOTMAP -->

<rootmap
        xmlns="https://example.org/ROOTMAP/OutputRulesSchema"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://example.org/ROOTMAP/OutputRulesSchema https://rootmapstorageaccount.blob.core.windows.net/rootmap-schemata-container/OutputRules.xsd">
<initialisation>
    <owner>DataOutputCoordinator</owner>
    <outputrule>
        <!-- For "RaytracerData", the <source> tag controls both
            (A) What will be the primary source for raytraced visualisation, and
            (B) Where the the raytraced scene will be centred.  
            
              If the <source> is a Plant name, its roots will be drawn and halfway down the Scoreboard from its <origin> point will be the centre. (see Plants.xml)
              If the <source> is the PlantCoordinator, all Plants' roots will be drawn and halfway down the Scoreboard from the geometric centre of all Plants' origins will be the centre.
              If the <source> is the ScoreboardRenderer, all Scoreboard boxes will be drawn and the geometric centre of the Scoreboards will be the centre. -->
        <source>ScoreboardRenderer</source>
        <type>RaytracerData</type>
        <stratum>Soil</stratum>
        <!--    Filename should be left as the default: Raytracer/DF3_Rootmap_Data%04u.inc (or Raytracer/SB_Rootmap_Data%04u.inc).
            The %04u suffix indicates that each frame's filename will be serialised
            with a 4-digit [U]nsigned integer (i.e. 0000, 0001, 0002, 0003, etc).
            The first file generated contains a list of all (zero or more) subsequent filenames.
            It is referenced by the main Rootmap_Scene.pov file
            to load every frame into the POV-ray scene. 
            (One serialised include file is generated for each frame)
            Count starts at zero due to convention.
            
            If changed, the new filename must be substituted for DF3_Rootmap_Data0000.inc
            in Rootmap_Scene.pov. The unserialised filename prefix must not end with a digit
            (i.e. Rootmap1%04u.inc is illegal). File extension must be .inc.
            -->
        <filename>Raytracer/DF3_Rootmap_Data%04u.inc</filename>
        <!-- specification1 is meaningful to the type.
            For "RaytracerData", specification1 is a comma-delimited list of extra Process names to be raytraced.
            
            (1) Type "all" to raytrace output from everything: the <source>, plus all raytracer-capable Processes,
                plus visualisation of all Scoreboard boxes (see Windows.xml : ViewCoordinator and View3DCoordinator).
            (2) Type a comma-delimited list of one or more Processes and/or "ScoreboardRenderer" to raytrace output from these
                in addition to the <source>.  E.g. <specification1>Nitrate, ScoreboardRenderer</specification1>
            (3) Leave <specification1> blank (or absent entirely) to raytrace output from the <source> only.     -->
        <specification1>PlantCoordinator,Nitrate</specification1>
        <!-- specification2 is used for setting the method of ScoreboardBox rendering.
			 <specification2>DF3</specification2> uses POV-ray's voxel-based density field format to represent the whole Scoreboard,
			 <specification2>SB</specification2> uses a rectangular prism of translucent media to represent each ScoreboardBox.
			 As a rule of thumb, DF3 is better for mathematically regular Scoreboard boundaries,
			 and SB is better for irregular Scoreboard box sizes.			 -->
        <specification2>DF3</specification2>
        <!-- <reopen> should always be set to OVERWRITE. POV-ray relies on the files generated by Rootmap
            being formatted correctly; appending data to existing files would corrupt them. -->
        <reopen>overwrite</reopen>
        <when>
            <!-- a count of zero is to repeat ad infinitum -->
            <count>5</count>
            <!-- Leave out all <when> elements except for count,
                (or set <interval> to all zeros) to use <count> as the frame count
                throughout the whole simulation. That is, <interval> will be calculated
                as [total sim runtime] / <count>.
                Of course if <count> is zero in this case, no output will be produced. -->
            <!--interval>0,0,2,12,0,0</interval>
            <initialtime>0,0,0,18,0,0</initialtime-->
        </when>
    </outputrule>
	<outputrule>
	  <source>ViewCoordinator</source>
	  <type>ViewCapture</type>
	  <stratum>Soil</stratum>
	  <filename>2D_test %02i.png</filename>
	  <!-- For ViewCaptureOutputStrategy, <specification1> is the zero-based index of the desired View window --> 
	  <specification1>0</specification1>
	  <!-- Use only <reopen>overwrite</reopen> -->
	  <reopen>overwrite</reopen>
	  <when>
		<!-- a count of zero is to repeat ad infinitum -->
		<count>10</count>
		<!-- For exporting "every" so often, use the initialtime and frequency tags
			 Year,Month,Day,Hour,Minute,Second -->
		<interval>0,0,0,6,0,0</interval>
		<initialtime>0,0,0,0,10,0</initialtime>
	  </when>
	</outputrule>
	<outputrule>
	  <source>View3DCoordinator</source>
	  <type>ViewCapture</type>
	  <stratum>Soil</stratum>
	  <filename>3D_test %02i.png</filename>
	  <!-- For ViewCaptureOutputStrategy, <specification1> is the zero-based index of the desired View window --> 
	  <specification1>0</specification1>
	  <!-- Use only <reopen>overwrite</reopen> -->
	  <reopen>overwrite</reopen>
	  <when>
		<!-- a count of zero is to repeat ad infinitum -->
		<count>50</count>
		<!-- For exporting "every" so often, use the initialtime and frequency tags
			 Year,Month,Day,Hour,Minute,Second -->
		<interval>0,0,0,6,0,0</interval>
		<initialtime>0,0,0,0,10,0</initialtime>
	  </when>
	</outputrule>
	</initialisation>
	
</rootmap>
